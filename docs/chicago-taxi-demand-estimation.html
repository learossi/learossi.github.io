<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Chicago Taxi Demand Estimation | Personal Projects</title>
  <meta name="description" content="6 Chicago Taxi Demand Estimation | Personal Projects" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Chicago Taxi Demand Estimation | Personal Projects" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Chicago Taxi Demand Estimation | Personal Projects" />
  
  
  



<meta name="date" content="2023-04-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-effect-of-seed-market-competition-on-farmers.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="convergence-of-m-estimators-made-simpler.html"><a href="convergence-of-m-estimators-made-simpler.html"><i class="fa fa-check"></i><b>1</b> Convergence of M-Estimators made simple(r)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="convergence-of-m-estimators-made-simpler.html"><a href="convergence-of-m-estimators-made-simpler.html#what-is-an-m-estimator"><i class="fa fa-check"></i><b>1.1</b> What is an M-Estimator?</a></li>
<li class="chapter" data-level="1.2" data-path="convergence-of-m-estimators-made-simpler.html"><a href="convergence-of-m-estimators-made-simpler.html#consistency"><i class="fa fa-check"></i><b>1.2</b> Consistency</a></li>
<li class="chapter" data-level="1.3" data-path="convergence-of-m-estimators-made-simpler.html"><a href="convergence-of-m-estimators-made-simpler.html#rate-of-convergence"><i class="fa fa-check"></i><b>1.3</b> Rate of Convergence</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="gaussian-process-mbo-for-random-forests.html"><a href="gaussian-process-mbo-for-random-forests.html"><i class="fa fa-check"></i><b>2</b> Gaussian Process MBO for Random Forests</a>
<ul>
<li class="chapter" data-level="2.1" data-path="gaussian-process-mbo-for-random-forests.html"><a href="gaussian-process-mbo-for-random-forests.html#overview-of-gaussian-processes"><i class="fa fa-check"></i><b>2.1</b> Overview of Gaussian Processes</a></li>
<li class="chapter" data-level="2.2" data-path="gaussian-process-mbo-for-random-forests.html"><a href="gaussian-process-mbo-for-random-forests.html#application-to-random-forests"><i class="fa fa-check"></i><b>2.2</b> Application to Random Forests</a></li>
<li class="chapter" data-level="2.3" data-path="gaussian-process-mbo-for-random-forests.html"><a href="gaussian-process-mbo-for-random-forests.html#data"><i class="fa fa-check"></i><b>2.3</b> Data</a></li>
<li class="chapter" data-level="2.4" data-path="gaussian-process-mbo-for-random-forests.html"><a href="gaussian-process-mbo-for-random-forests.html#results"><i class="fa fa-check"></i><b>2.4</b> Results</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="gaussian-process-mbo-for-random-forests.html"><a href="gaussian-process-mbo-for-random-forests.html#grid-search"><i class="fa fa-check"></i><b>2.4.1</b> Grid Search</a></li>
<li class="chapter" data-level="2.4.2" data-path="gaussian-process-mbo-for-random-forests.html"><a href="gaussian-process-mbo-for-random-forests.html#gaussian-process-search"><i class="fa fa-check"></i><b>2.4.2</b> Gaussian Process Search</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="gaussian-process-mbo-for-random-forests.html"><a href="gaussian-process-mbo-for-random-forests.html#discussion"><i class="fa fa-check"></i><b>2.5</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-effect-of-increased-campaign-spending-on-election-results.html"><a href="the-effect-of-increased-campaign-spending-on-election-results.html"><i class="fa fa-check"></i><b>3</b> The Effect of Increased Campaign Spending on Election Results</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-effect-of-increased-campaign-spending-on-election-results.html"><a href="the-effect-of-increased-campaign-spending-on-election-results.html#background"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="the-effect-of-increased-campaign-spending-on-election-results.html"><a href="the-effect-of-increased-campaign-spending-on-election-results.html#motivating-trends"><i class="fa fa-check"></i><b>3.2</b> Motivating Trends</a></li>
<li class="chapter" data-level="3.3" data-path="the-effect-of-increased-campaign-spending-on-election-results.html"><a href="the-effect-of-increased-campaign-spending-on-election-results.html#initial-regression-analysis"><i class="fa fa-check"></i><b>3.3</b> Initial Regression Analysis</a></li>
<li class="chapter" data-level="3.4" data-path="the-effect-of-increased-campaign-spending-on-election-results.html"><a href="the-effect-of-increased-campaign-spending-on-election-results.html#iv-regression"><i class="fa fa-check"></i><b>3.4</b> IV Regression</a></li>
<li class="chapter" data-level="3.5" data-path="the-effect-of-increased-campaign-spending-on-election-results.html"><a href="the-effect-of-increased-campaign-spending-on-election-results.html#discussion-conclusion"><i class="fa fa-check"></i><b>3.5</b> Discussion &amp; Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="neural-network-methods-for-electricity-demand-forecasting.html"><a href="neural-network-methods-for-electricity-demand-forecasting.html"><i class="fa fa-check"></i><b>4</b> Neural Network Methods for Electricity Demand Forecasting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="neural-network-methods-for-electricity-demand-forecasting.html"><a href="neural-network-methods-for-electricity-demand-forecasting.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="neural-network-methods-for-electricity-demand-forecasting.html"><a href="neural-network-methods-for-electricity-demand-forecasting.html#common-neural-network-designs-for-forecasting"><i class="fa fa-check"></i><b>4.2</b> Common Neural Network Designs for Forecasting</a></li>
<li class="chapter" data-level="4.3" data-path="neural-network-methods-for-electricity-demand-forecasting.html"><a href="neural-network-methods-for-electricity-demand-forecasting.html#problem-statement-and-data"><i class="fa fa-check"></i><b>4.3</b> Problem Statement and Data</a></li>
<li class="chapter" data-level="4.4" data-path="neural-network-methods-for-electricity-demand-forecasting.html"><a href="neural-network-methods-for-electricity-demand-forecasting.html#lstm-results"><i class="fa fa-check"></i><b>4.4</b> LSTM Results</a></li>
<li class="chapter" data-level="4.5" data-path="neural-network-methods-for-electricity-demand-forecasting.html"><a href="neural-network-methods-for-electricity-demand-forecasting.html#cnn-results"><i class="fa fa-check"></i><b>4.5</b> CNN Results</a></li>
<li class="chapter" data-level="4.6" data-path="neural-network-methods-for-electricity-demand-forecasting.html"><a href="neural-network-methods-for-electricity-demand-forecasting.html#analysis"><i class="fa fa-check"></i><b>4.6</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-effect-of-seed-market-competition-on-farmers.html"><a href="the-effect-of-seed-market-competition-on-farmers.html"><i class="fa fa-check"></i><b>5</b> The Effect of Seed Market Competition on Farmers</a></li>
<li class="chapter" data-level="6" data-path="chicago-taxi-demand-estimation.html"><a href="chicago-taxi-demand-estimation.html"><i class="fa fa-check"></i><b>6</b> Chicago Taxi Demand Estimation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chicago-taxi-demand-estimation.html"><a href="chicago-taxi-demand-estimation.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chicago-taxi-demand-estimation.html"><a href="chicago-taxi-demand-estimation.html#data-1"><i class="fa fa-check"></i><b>6.1.1</b> Data</a></li>
<li class="chapter" data-level="6.1.2" data-path="chicago-taxi-demand-estimation.html"><a href="chicago-taxi-demand-estimation.html#trends"><i class="fa fa-check"></i><b>6.1.2</b> Trends</a></li>
<li class="chapter" data-level="6.1.3" data-path="chicago-taxi-demand-estimation.html"><a href="chicago-taxi-demand-estimation.html#possible-estimation-procedures"><i class="fa fa-check"></i><b>6.1.3</b> Possible Estimation Procedures</a></li>
<li class="chapter" data-level="6.1.4" data-path="chicago-taxi-demand-estimation.html"><a href="chicago-taxi-demand-estimation.html#stl-decomposition"><i class="fa fa-check"></i><b>6.1.4</b> STL Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chicago-taxi-demand-estimation.html"><a href="chicago-taxi-demand-estimation.html#full-data-procedures"><i class="fa fa-check"></i><b>6.2</b> Full Data Procedures</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Personal Projects</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chicago-taxi-demand-estimation" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Chicago Taxi Demand Estimation<a href="chicago-taxi-demand-estimation.html#chicago-taxi-demand-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Introduction<a href="chicago-taxi-demand-estimation.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Demand estimation is an important topic for businesses of any kind: accurate demand forecasts can allow them to operate on higher margins while poor forecasts risk either disappointing clients due to a lack of supply or saddling the business with excessive or labor without a buyer for the product. While the input for the taxi market is just labor, the analysis is no different. Fortunately, the City of Chicago has a dataset where they release data on the time rounded to the nearest quarter hour, location, and duration of literally every taxi ride in the city (or at least that’s what they say). This dataset allows us to do fairly robust demand estimation due to its granularity. The most important decision for a taxi decision for a taxi firm is a) when to hire more drivers, and b) when to schedule more drivers. To this end, I will be doing both seasonal and daily trend predictions. Unfortunately, observed quantity is endogenous. Attempts to supply more taxis within the data period will increase observed quantity (which I might erroneously interpret as increased demand): fortunatley, the data allows reparametrizations that decrease these concerns which I will explore at the end.</p>
<div id="data-1" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Data<a href="chicago-taxi-demand-estimation.html#data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The dataset provided by the City of Chicago is quite robust in that it appears to be quite clean already. The problem is that each row is an individual ride and the timespan of the dataset is 2002 to present. Chicago is a big city with a lot of people and a substantial number of taxis. The resulting dataset has over 200 million observations. My computer is puny and even SQL queries to a local server are very slow. So, I’ll be first analyzing 2022 data as an outline of our methods and approaches and then extend this analysis and restimate models with multiple years later.
The dataset also allows multiple ways to estimate demand. Ride data comes with length, time, and fare data which might allow us to create a more accurate picture of demand. For the first part, we will use count data, but then diversify to other types of demand measures later.</p>
</div>
<div id="trends" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Trends<a href="chicago-taxi-demand-estimation.html#trends" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is multiple levels on which one can examine demand in this dataset. The most trivial would be to examine raw number of rides within a timespan.
<br>
<img src="Chicago-Taxi_files/figure-html/raw_data-1.png" width="672" /></p>
<p>There are already some interesting trends in this data at first glance. For one, there is a solid trend upwards through most of the study period until around November at which point the demand seems to dip back down. Chicago gets very cold in winters and it makes sense that demand would be negatively affected during that period. However, demand does not seem to achieve the lows that it did at the start of the previous year which would suggest long term growth in the demand for taxis. From a technical perspective, the demand is definitely not stationary and is looking like it might not even be first-difference stationary.
On a slightly different topic, the variance of the measurements increase as the year goes on which has two separate implications: OLS isn’t going to be enough here. If we wanted to use regression we would need something like a quasi-likelihood model that controls for heteroskedasicity in order to get meaningful confidence intervals. Secondly, if we want to use some sort of exponential smoothing model, the increased variance suggests that the right approach is to use one with multiplicative trends as opposed to additive ones (more on this later).</p>
<p>The next important question is what kind of seasonality is there in this data. We’ll address year seasonality later, but right now we can visualize daily and weekly seasonality already present in the data.</p>
<p><img src="Chicago-Taxi_files/figure-html/smoothed_rides-1.png" width="672" /></p>
<p>The previous graph shows a 100 tap moving average filter that is fitted to demand measurements at the lowest granualarity: counts of rides numbers in 15 minute bins supplied in the dataset. The distinct peaks that we can see correspond to weeklong periods. Plotting average number of rides by weekday gives the following graph:</p>
<p><img src="Chicago-Taxi_files/figure-html/Avg_WkDay-1.png" width="672" /></p>
<p>If you look on the y axis, the differences between low volume days and high volume days is only 10% or so, but this is still enough to create a noticeable seasonal trend that shows up in the weighted average.</p>
<p>There are also clear seasonal trends across days in the day that look roughly similar to a sine wave. We can group data by time of day (without controlling for anything else) and get the following visualization:</p>
<p><img src="Chicago-Taxi_files/figure-html/ToD_Decomp-1.png" width="672" /></p>
<p>This isn’t quite sinusoidal, but it’s close, and it’s about what we would expect if demand was a smooth function of time of day. Note that, once again linear regression isn’t an appropriate choice here. Even polynomial regression is undesirable as the Taylor series of a sine wave converges rather slowly on the boundary of a compact interval centered on the point of expansion compared to the center of the set which results in more parameters than necessary.</p>
<p>Not to spoil the fun, but there are going to be seasonal yearly trends in this dataset too which complicate our ability to apply simple estimation procedures.</p>
</div>
<div id="possible-estimation-procedures" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Possible Estimation Procedures<a href="chicago-taxi-demand-estimation.html#possible-estimation-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Not to beat a dead horse here, but our data is not stationary. Applying a KPSS test with a null hypothesis that the data is trend stationary gives a significant p-value. One of the primary reasons for this seems to be the seasonality which we have a variety of ways to deal with.</p>
<pre><code>## 
##  KPSS Test for Trend Stationarity
## 
## data:  as.numeric(daily_rides_2022$num_rides)
## KPSS Trend = 0.29748, Truncation lag parameter = 16, p-value = 0.01</code></pre>
<p>The basic approach to seasonal time-series modeling is to use some sort of moderately flexible exponential-smoothing/FIR model that has the ability to remove a seasonality or trend component specified by the researcher. SARIMA, Holt-Winters, and periodogram based approaches are all examples. The problem with all the previous approaches is that they only allow the specification of one seasonal component. Obviously, one could estimate seasonal components separately through use of some sort of restricted AR model and then use a standard estimation technique on the residuals. However, this approach is undesirable as having models with multiple levels are hard to debug and allow model error to more easily be propagated through residuals as opposed to estimating all the parameters simultaneously.</p>
<p>This means a more flexible model is needed in order to fit. One upside of our data is that we can be pretty sure that season periods are fixed. This means that flexible season length methods like STL aren’t strictly necessary, but it actually ends up to work pretty well here so that’s what we’re going to use.</p>
<p>The main challenge in working with this data is the nonconstant variance structure which limits the effectiveness of highly parametric methods and pushes us towards more flexible local methods. There are a few possible ways to deal with this issue. The easiest is to transform the data to create a more desirable variance structure: the most common transformation is obviously the logarithm where the compressive nature of the log pushes variances closer together (this also has the benefit of turning multiplicative relationships into additive ones). Taking the log actually works pretty well here and generates data that looks like it has normal errors but doesn’t necessarily mean that Holt-Winters performs well.</p>
<p>Another possible approach is to model the variance explicitly: the easiest method would be fitting some sort of quasi-likelihood model to the time series. However, we find this approach generally suspicious unless one has a prior that the variance conforms to a set structure. There also isn’t much literature on this approach and I don’t want to code a package that implements something like that…so there you go. Luckily, the dual approach to this is to use a method that is flexible enough to model the variance itself which is well studied and has a few good algorithms for time-series.</p>
<p>We’ve already spoiled that we’re choosing the third option and using STL to perform the trend/seasonality decomposition. So, let’s get to it.</p>
</div>
<div id="stl-decomposition" class="section level3 hasAnchor" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> STL Decomposition<a href="chicago-taxi-demand-estimation.html#stl-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One challenge with forecasting in the smaller context we’re operating in right now is that we don’t know if the dip down at the end of the period is a yearly seasonal effect or just an exogenous shock. There’s not a ton to do about this right now, but just be aware there’s some grains of salt to be had until we move to the full analysis.<br />
<br>
<img src="Chicago-Taxi_files/figure-html/2022_STLM-1.png" width="672" /></p>
<p>As is easily apparent, the STL decomposition for the trend is pretty gritty, but that’s a benefit insomuch as it allows us to get a stable estimate of the seasonal component that changes relatively little over the course of the study period. Basically all modern time series procedures involve a decomposition of a series into trend-cycle, seasonal, and irregular elements and the estimation of those elements individually. STL gives me that decomposition that I can then play with in order to get a good approximation of the next few periods. The strategy is pretty simple. The last few samples of the seasonal decomposition give me an estimate of the trend-cycle at that point (this can be estimated using a constant or interpolating polynomials (I use interpolating loosely here), where I choose the latter). Seasonality can be estimated simply repeating the next few samples of what it would have been from the previous season and the irregularities can be estimated using a feedforward ARIMA design. A nice benefit of the ARIMA approach to estimating irregularities is that it preserves variance without transforming the data thus aiding in interprebility.</p>
<p>Here I present a ten day forecast for demand. You can also theoretically do the same procedure for hourly demand with a less flexible LOESS selection and day seasonality on top of week seasonality.</p>
<p><img src="Chicago-Taxi_files/figure-html/predict_dailies-1.png" width="672" />
Note that the confidence intervals are only the sum of the natural intervals from the ARIMA model and the prediction intervals from the interpolating polynomial (note that the constant residual variance assumption for the prediction intervals is approximately satisfied since we’re only pulling from a rough period near the end of the series).</p>
<p>Note that this specification doesn’t guard against model error and the projection would have done a very poor job of predicting the downturn if they had been taken a few weeks prior. In that sense, the confidence intervals are very optimistic (especially considering that we will see there is yearly seasonality that hasn’t been accounted for). However, they do provide an easy an decomposable heuristic for prediction which we will undertake in the next section with the whole data.</p>
</div>
</div>
<div id="full-data-procedures" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Full Data Procedures<a href="chicago-taxi-demand-estimation.html#full-data-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The full data contains all taxi rides from 2013 to 2022 in Chicago and allows us to decompose year trends from trend-cycle data.</p>
<p><img src="Chicago-Taxi_files/figure-html/full_data_average-1.png" width="672" /></p>
<p>A few things are notable about the full data. For one, yearly seasonality is easy to observe in this context where demand peaks during the middle of the year and tapers off in the colder months (when it is perhaps understandable that people have less desire to be outside in the Chicago winter). Another important note is that the start of the coronavirus pandemic is easy to observe near the beginning of 2020 and has a clear effect on both the level and the variance of the data. Longer term trends in demand are also present in the data. Demand seems to rise between 2013 and 2015 while declining before the pandemic (perhaps due to greater competition from rideshare services or due to demographic trends in Chicago itself). It is also easy to observe a level effect on the variance that is most apparent in the summer months and post-Covid.</p>
<p>Given the our trend-cycle estimates come from STL which is a fairly flexible method, we really don’t need to modify the previous procedure except to add seasonality (besides that fact that I’m going to be waiting around a lot longer for my computer to plod through all the data). So, let’s do that.</p>
<p>Training is essentially identical and we get an STL decomposition, a trained ARIMA model, and a fitting procedure after all is said and done. Let’s see how the model forecasts the last week of the data compared to the actual data:</p>
<p><img src="Chicago-Taxi_files/figure-html/pred_plot-1.png" width="672" /></p>
<p>As can be seen, the estimation method tracks relatively well with the actual data. Obviously, much of this is owed to the relatively stable seasonality and the existence of a non-stochastic trend element. Nonetheless, this method is both easy to implement in many common statistical packages and is relatively easily interpreble given that there is an explicit decomposition in the method between the seasonal, trend-cycle, and irregular elements. This makes it easy to use and to extend.</p>

<div id="refs" class="references csl-bib-body hanging-indent">
<div class="csl-entry">
Van der Vaart, A. W. 2000. <em>Asymptotic Statistics</em>. Cambridge University Press.
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-effect-of-seed-market-competition-on-farmers.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
